<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>測試記住帳號功能</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            max-width: 600px;
            margin: 50px auto;
            padding: 20px;
            background: #f5f5f5;
        }
        .test-section {
            background: white;
            padding: 20px;
            margin: 20px 0;
            border-radius: 8px;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
        }
        .test-button {
            background: #4299e1;
            color: white;
            border: none;
            padding: 10px 20px;
            border-radius: 5px;
            cursor: pointer;
            margin: 5px;
        }
        .test-button:hover {
            background: #3182ce;
        }
        .result {
            background: #e6fffa;
            border: 1px solid #38b2ac;
            padding: 10px;
            margin: 10px 0;
            border-radius: 5px;
        }
        input[type="email"] {
            width: 100%;
            padding: 8px;
            margin: 5px 0;
            border: 1px solid #ddd;
            border-radius: 4px;
        }
    </style>
</head>
<body>
    <h1>🧪 測試記住帳號功能</h1>
    
    <div class="test-section">
        <h3>模擬記住帳號操作</h3>
        <label>
            <input type="checkbox" id="rememberCheckbox"> 記住帳號
        </label>
        <br><br>
        <label>
            Email: <input type="email" id="emailInput" placeholder="請輸入 Email">
        </label>
        <br><br>
        <button class="test-button" onclick="saveAccount()">儲存設定</button>
        <button class="test-button" onclick="loadAccount()">載入設定</button>
        <button class="test-button" onclick="clearAccount()">清除設定</button>
        <div id="saveResult" class="result" style="display:none;"></div>
    </div>

    <div class="test-section">
        <h3>測試結果</h3>
        <button class="test-button" onclick="checkLocalStorage()">檢查 LocalStorage</button>
        <div id="storageResult" class="result" style="display:none;"></div>
    </div>

    <script>
        const REMEMBER_ACCOUNT_KEY = 'vue-lucky-draw-remember-account';
        const SAVED_EMAIL_KEY = 'vue-lucky-draw-saved-email';

        function saveAccount() {
            const rememberCheckbox = document.getElementById('rememberCheckbox');
            const emailInput = document.getElementById('emailInput');
            const resultDiv = document.getElementById('saveResult');

            try {
                if (rememberCheckbox.checked && emailInput.value) {
                    localStorage.setItem(REMEMBER_ACCOUNT_KEY, 'true');
                    localStorage.setItem(SAVED_EMAIL_KEY, emailInput.value);
                    resultDiv.innerHTML = `✅ 已儲存帳號: ${emailInput.value}`;
                    resultDiv.style.background = '#c6f6d5';
                } else {
                    localStorage.removeItem(REMEMBER_ACCOUNT_KEY);
                    localStorage.removeItem(SAVED_EMAIL_KEY);
                    resultDiv.innerHTML = '🗑️ 已清除記住的帳號設定';
                    resultDiv.style.background = '#fed7d7';
                }
                resultDiv.style.display = 'block';
            } catch (error) {
                resultDiv.innerHTML = `❌ 錯誤: ${error.message}`;
                resultDiv.style.background = '#fed7d7';
                resultDiv.style.display = 'block';
            }
        }

        function loadAccount() {
            const rememberCheckbox = document.getElementById('rememberCheckbox');
            const emailInput = document.getElementById('emailInput');
            const resultDiv = document.getElementById('saveResult');

            try {
                const savedRemember = localStorage.getItem(REMEMBER_ACCOUNT_KEY);
                const savedEmail = localStorage.getItem(SAVED_EMAIL_KEY);

                if (savedRemember === 'true' && savedEmail) {
                    rememberCheckbox.checked = true;
                    emailInput.value = savedEmail;
                    resultDiv.innerHTML = `📧 已載入記住的帳號: ${savedEmail}`;
                    resultDiv.style.background = '#c6f6d5';
                } else {
                    rememberCheckbox.checked = false;
                    emailInput.value = '';
                    resultDiv.innerHTML = '📭 沒有找到記住的帳號';
                    resultDiv.style.background = '#f7fafc';
                }
                resultDiv.style.display = 'block';
            } catch (error) {
                resultDiv.innerHTML = `❌ 錯誤: ${error.message}`;
                resultDiv.style.background = '#fed7d7';
                resultDiv.style.display = 'block';
            }
        }

        function clearAccount() {
            localStorage.removeItem(REMEMBER_ACCOUNT_KEY);
            localStorage.removeItem(SAVED_EMAIL_KEY);
            document.getElementById('rememberCheckbox').checked = false;
            document.getElementById('emailInput').value = '';
            const resultDiv = document.getElementById('saveResult');
            resultDiv.innerHTML = '🧹 已清除所有設定';
            resultDiv.style.background = '#f7fafc';
            resultDiv.style.display = 'block';
        }

        function checkLocalStorage() {
            const resultDiv = document.getElementById('storageResult');
            const rememberValue = localStorage.getItem(REMEMBER_ACCOUNT_KEY);
            const emailValue = localStorage.getItem(SAVED_EMAIL_KEY);

            const html = `
                <h4>LocalStorage 內容:</h4>
                <p><strong>記住帳號:</strong> ${rememberValue || '(未設定)'}</p>
                <p><strong>儲存的 Email:</strong> ${emailValue || '(未設定)'}</p>
                <p><strong>所有相關項目:</strong></p>
                <pre>${JSON.stringify({
                    [REMEMBER_ACCOUNT_KEY]: rememberValue,
                    [SAVED_EMAIL_KEY]: emailValue
                }, null, 2)}</pre>
            `;
            resultDiv.innerHTML = html;
            resultDiv.style.display = 'block';
        }

        // 頁面載入時自動載入設定
        window.onload = function() {
            loadAccount();
        };

        // 監聽 checkbox 變更
        document.getElementById('rememberCheckbox').addEventListener('change', function() {
            if (!this.checked) {
                clearAccount();
            }
        });

        // 監聽 email 變更
        document.getElementById('emailInput').addEventListener('input', function() {
            const rememberCheckbox = document.getElementById('rememberCheckbox');
            if (rememberCheckbox.checked) {
                setTimeout(saveAccount, 300); // 延遲儲存，避免過度觸發
            }
        });
    </script>
</body>
</html>
