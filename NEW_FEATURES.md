# 🎯 Vue Lucky Draw 新功能說明

## 🆕 最新更新功能

### 1. 👤 用戶參與系統
- **管理員參與**：管理員可以勾選自己參加抽球活動
- **參加者控制**：註冊用戶可以自主選擇參加或暫停參與
- **保留帳號**：暫停參與時保留用戶帳號，可隨時重新參與
- **參與狀態顯示**：清楚顯示每個玩家的參與狀態（參與中/暫停參與）

### 2. 🔐 忘記密碼功能
- **Magic Link 重設**：支援透過 Email 重設密碼
- **安全流程**：使用 Supabase Auth 的安全重設流程
- **重設頁面**：專屬的密碼重設介面
- **即時驗證**：密碼強度與確認驗證

### 3. 🔄 系統重置功能
- **重置當局**：清空所有玩家球數，保留玩家與歷史記錄
- **重置全部資料**：完全清除所有玩家、歷史記錄，回到初始狀態
- **安全確認**：多重確認機制防止誤操作
- **管理員專屬**：只有管理員可以執行重置操作

### 4. 🎯 智能抽球優化
- **參與過濾**：只從參與中的玩家進行抽球
- **動態統計**：即時更新參與玩家數量與總球數
- **狀態管理**：精確追蹤每個玩家的參與狀態

## 💡 使用方式

### 管理員功能
1. **登入管理後台**：使用 Magic Link 登入
2. **玩家管理**：
   - 新增玩家
   - 調整球數（+1/-1）
   - 編輯玩家資訊
   - 切換參與狀態（⏸️/▶️）
   - 刪除玩家
3. **抽球控制**：
   - 執行抽球（只從參與中的玩家抽取）
   - 清空所有球數
4. **系統重置**：
   - 重置當局（保留玩家）
   - 重置全部資料（完全清除）
5. **參與抽球**：管理員也可以加入抽球活動

### 參加者功能
1. **登入系統**：使用 Email Magic Link 登入
2. **參與控制**：
   - 加入抽球活動
   - 暫停參與（保留帳號）
   - 重新參與
   - 修改顯示名稱
3. **查看資訊**：
   - 查看自己的球數
   - 查看排行榜
   - 查看抽球歷史

### 訪客功能
- 查看排行榜
- 查看抽球歷史
- 查看統計資訊

## 🔧 技術特性

### 資料庫改進
- 新增 `is_participating` 欄位控制參與狀態
- 新增 `user_id` 欄位關聯用戶帳號
- 新增 `user_participations` 表管理參與狀態
- 優化 RLS 權限政策

### 前端改進
- 新增 `useParticipation` composable 管理參與狀態
- 擴展 `useAuth` composable 支援密碼重設
- 新增密碼重設頁面
- 優化響應式設計
- 改進 UI/UX 體驗

### 安全性提升
- 多重確認重置操作
- 角色權限精確控制
- 安全的密碼重設流程
- 防誤操作機制

## 📱 手機適配

所有新功能都完全支援手機瀏覽器：
- 響應式參與控制介面
- 觸控友好的按鈕設計
- 適配小螢幕的表單佈局
- 優化的模態框顯示

## 🎮 使用流程

### 首次設置
1. 管理員登入後台設置用戶角色
2. 用戶使用 Magic Link 登入
3. 用戶選擇加入抽球活動
4. 管理員為參與者分配球數

### 抽球流程
1. 確認參與者列表和球數分配
2. 管理員執行抽球
3. 系統自動從參與中的玩家抽取
4. 中獎者球數自動減1
5. 記錄抽球歷史

### 重置流程
1. 當局結束後，管理員可選擇：
   - 重置當局：保留玩家，清空球數
   - 重置全部：完全重新開始
2. 確認操作後執行重置
3. 系統回到對應狀態

這些新功能讓抽球系統更加靈活、安全和用戶友好！🎉
